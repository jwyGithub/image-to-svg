# 图片转 SVG 工具

一个基于 Next.js + TypeScript 构建的在线图片转 SVG 工具，支持批量处理和历史记录管理。

## ✨ 功能特性

### 🖼️ 图片转换

-   **多格式支持**: 支持 JPG、PNG、GIF、WebP、BMP 等主流图片格式
-   **批量处理**: 一次性上传和转换多个文件（无数量限制）
-   **文件大小限制**: 单文件最大支持 10MB
-   **SVG 模板**: 使用标准 SVG 模板，将图片嵌入为 base64 格式

### 🚀 用户体验

-   **拖拽上传**: 支持拖拽文件到页面进行上传
-   **实时进度**: 显示每个文件的转换进度和整体进度
-   **并发控制**: 智能控制并发数量，防止浏览器卡死
-   **错误处理**: 完善的错误提示和异常处理

### 📁 文件管理

-   **单个下载**: 支持下载单个转换后的 SVG 文件
-   **批量下载**: 支持批量下载所有转换成功的文件
-   **文件预览**: 在新窗口中预览生成的 SVG 文件
-   **文件名保持**: 转换后的文件名与原文件名一致（扩展名改为.svg）

### 💾 历史记录

-   **自动保存**: 转换完成后自动保存到历史记录
-   **IndexDB 存储**: 使用浏览器 IndexDB 进行本地存储
-   **历史管理**: 查看、删除、清空历史记录
-   **快速操作**: 从历史记录中快速下载和预览文件

## 🛠️ 技术架构

### 前端技术栈

-   **Next.js 15**: React 全栈框架
-   **TypeScript**: 类型安全的 JavaScript
-   **Tailwind CSS**: 原子化 CSS 框架
-   **shadcn/ui**: 现代化 UI 组件库
-   **Lucide React**: 图标库

### 核心模块

-   **类型定义** (`src/lib/types.ts`): 完整的 TypeScript 类型定义
-   **SVG 模板服务** (`src/lib/svg-template.ts`): 处理图片转 SVG 的核心逻辑
-   **转换服务** (`src/lib/conversion.ts`): 批量转换任务管理
-   **存储服务** (`src/lib/storage.ts`): IndexDB 历史记录管理
-   **下载服务** (`src/lib/download.ts`): 文件下载和预览功能

### 组件架构

-   **文件上传组件** (`src/components/file-upload.tsx`): 文件选择和验证
-   **转换进度组件** (`src/components/conversion-progress.tsx`): 进度展示和控制
-   **历史记录面板** (`src/components/history-panel.tsx`): 历史记录管理界面

## 🚀 部署说明

### 本地开发

```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm dev

# 构建生产版本
pnpm build
```

### Cloudflare Pages 部署

```bash
# 构建用于Cloudflare Pages的版本
pnpm deploy

# 预览部署
pnpm preview
```

## 📝 使用说明

### 基本使用流程

1. **上传文件**: 拖拽图片文件到上传区域或点击选择文件
2. **开始转换**: 点击"开始转换"按钮开始批量处理
3. **查看进度**: 实时查看每个文件的转换进度
4. **下载文件**: 转换完成后可单个下载或批量下载
5. **查看历史**: 在历史记录中管理之前的转换结果

### 支持的文件格式

-   JPEG/JPG
-   PNG
-   GIF
-   WebP
-   BMP
-   SVG (会重新处理)

### 转换规则

1. 获取图片的宽度和高度信息
2. 将图片转换为 base64 编码
3. 使用 SVG 模板生成最终的 SVG 文件
4. 保持原始文件名，扩展名改为.svg

## 🔧 配置选项

### 环境变量

项目支持以下环境变量配置：

-   可在 `.dev.vars` 文件中配置开发环境变量

### 自定义配置

-   文件数量：现已移除数量限制，支持无限制批量处理
-   最大文件大小：在文件验证逻辑中可调整大小限制
-   并发处理数：在 `ConversionService` 中可调整 `maxWorkers`

## 🎯 性能优化

### 前端优化

-   使用并发控制避免浏览器卡死
-   实现文件去重避免重复处理
-   懒加载和代码分割
-   优化的错误处理和用户反馈

### 存储优化

-   使用 IndexDB 进行本地持久化存储
-   智能的存储空间管理
-   批量操作优化

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

